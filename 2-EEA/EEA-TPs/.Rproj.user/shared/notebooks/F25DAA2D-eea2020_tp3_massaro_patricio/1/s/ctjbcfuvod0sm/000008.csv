"0","# Definición de fórmulas y creación de modelos, luego vemos uno por uno"
"0","logit_formulas <- formulas("
"0","                           .response = ~Survived, "
"0","                           baseline_model = ~ Pclass+Sex+Age,"
"0","                           onevariable_model = ~Pclass,"
"0","                           total_model = ~. -PassengerId,"
"0","                           newvariable_model = ~ Pclass + Sex + Age  + SibSp + viaja_solo,"
"0","                           "
"0","                          )"
"0","models <- tibble(logit_formulas) %>% "
"0","            mutate("
"0","              models = names(logit_formulas),"
"0","              expression = paste(logit_formulas), "
"0","              mod = map(logit_formulas, ~glm(., family = 'binomial', data = Titanic_train_train))"
"0","            ) "
"0",""
"0",""
"0","# Añadimos las predicciones en datos de entrenamiento, validación y test"
"0","models <- models %>% "
"0","  mutate("
"0","    pred_train= map(mod,augment, type.predict = ""response""),"
"0","    pred_val = map(mod,augment,newdata=Titanic_train_validation,type.predict = ""response""),"
"0","    pred_test = map(mod,augment,newdata=Titanic_test,type.predict = ""response"")"
"0","  )"
"0",""
"0",""
"0","# Abrimos un summary del modelo propuesto por el enunciado"
"0","models %>% "
"0","  filter(models == ""baseline_model"") %>%"
"0","  mutate(tidy = map(mod, tidy))  %>% "
"0","  unnest(tidy)%>% "
"0","  mutate(estimate=round(estimate,5),"
"0","         p.value=round(p.value,4))"
